(function(t){function e(e){for(var n,i,s=e[0],c=e[1],l=e[2],u=0,d=[];u<s.length;u++)i=s[u],Object.prototype.hasOwnProperty.call(r,i)&&r[i]&&d.push(r[i][0]),r[i]=0;for(n in c)Object.prototype.hasOwnProperty.call(c,n)&&(t[n]=c[n]);p&&p(e);while(d.length)d.shift()();return o.push.apply(o,l||[]),a()}function a(){for(var t,e=0;e<o.length;e++){for(var a=o[e],n=!0,s=1;s<a.length;s++){var c=a[s];0!==r[c]&&(n=!1)}n&&(o.splice(e--,1),t=i(i.s=a[0]))}return t}var n={},r={app:0},o=[];function i(e){if(n[e])return n[e].exports;var a=n[e]={i:e,l:!1,exports:{}};return t[e].call(a.exports,a,a.exports,i),a.l=!0,a.exports}i.m=t,i.c=n,i.d=function(t,e,a){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:a})},i.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(i.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)i.d(a,n,function(e){return t[e]}.bind(null,n));return a},i.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="/TheF2E-Vue-MaskMap/";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],c=s.push.bind(s);s.push=e,s=s.slice();for(var l=0;l<s.length;l++)e(s[l]);var p=c;o.push([0,"chunk-vendors"]),a()})({0:function(t,e,a){t.exports=a("56d7")},"56d7":function(t,e,a){"use strict";a.r(e);a("e260"),a("e6cf"),a("cca6"),a("a79d");var n=a("2b0e"),r=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"app"}},[n("loading",{attrs:{loader:"bars",color:"#3986f7",active:t.isLoading,transition:"",name:"fade"},on:{"update:active":function(e){t.isLoading=e}}},[n("template",{slot:"default"},[n("img",{staticClass:"loading-logo",attrs:{src:a("ace3"),alt:"",width:"80"}}),n("div",{staticClass:"lds-ellipsis"},[n("div"),n("div"),n("div"),n("div")])])],2),n("div",{class:{toggle:!0===t.isToggle},attrs:{id:"side-menu"}},[n("div",{staticClass:"sticky-wrap"},[t._m(0),n("select",{directives:[{name:"model",rawName:"v-model",value:t.selected.county,expression:"selected.county"}],staticClass:"form-control county",attrs:{name:"county"},on:{change:[function(e){var a=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.$set(t.selected,"county",e.target.multiple?a:a[0])},function(e){t.selected.town=null}]}},t._l(t.getCounty,(function(e,a){return n("option",{key:a,domProps:{value:e}},[t._v(" "+t._s(e)+" ")])})),0),n("select",{directives:[{name:"model",rawName:"v-model",value:t.selected.town,expression:"selected.town"}],staticClass:"form-control town",attrs:{name:"town"},on:{change:function(e){var a=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.$set(t.selected,"town",e.target.multiple?a:a[0])}}},[n("option",{attrs:{value:"null",disabled:""}},[t._v(" -- 請選擇 -- ")]),t._l(t.getTown,(function(e,a){return n("option",{key:a},[t._v(" "+t._s(e)+" ")])}))],2),n("p",{staticClass:"count"},[n("fa",{attrs:{icon:["fas","clinic-medical"]}}),t._v(" 剩餘口罩藥局 "),n("span",[t._v(" "+t._s(t.filterMaskCount.length)+" ")]),t._v(" / "),n("span",{staticClass:"total"},[t._v(t._s(t.filterPharmacy.length)+" ")]),t._v("家 ")],1)]),n("div",{staticClass:"list-wrap"},t._l(t.filterPharmacy,(function(e){return n("a",{key:e.properties.id,staticClass:"item",attrs:{href:"#"},on:{click:function(a){return a.preventDefault(),t.clickPharmacy(e)}}},[n("h3",[t._v(t._s(e.properties.name))]),n("p",[n("fa",{attrs:{icon:["fas","map-marker-alt"]}}),t._v(" "+t._s(e.properties.address)+" ")],1),n("p",[n("fa",{attrs:{icon:["fas","phone-alt"]}}),t._v(" "+t._s(e.properties.phone)+" ")],1),n("div",{staticClass:"mask-counts"},[n("div",{staticClass:"count adult",class:{zero:0===e.properties.mask_adult}},[n("p",[t._v("成人口罩")]),n("h4",[t._v(t._s(e.properties.mask_adult)+" "),n("span",[t._v("片")])]),n("img",{staticClass:"icon",attrs:{src:a("edfe"),alt:""}})]),n("div",{staticClass:"count child",class:{zero:0===e.properties.mask_child}},[n("p",[t._v("兒童口罩")]),n("h4",[t._v(t._s(e.properties.mask_child)+" "),n("span",[t._v("片")])]),n("img",{staticClass:"icon",attrs:{src:a("7ffa"),alt:""}})])])])})),0),n("a",{staticClass:"toggle-btn",attrs:{href:"#"},on:{click:function(e){e.preventDefault(),t.isToggle=!t.isToggle}}},[n("i",{staticClass:"material-icons"},[t._v("chevron_left")])])]),n("div",{staticClass:"map-container",attrs:{id:"map"}})],1)},o=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("h1",[a("div",{staticClass:"logo"}),a("div",{staticClass:"title"},[a("span",[t._v("口罩地圖")]),a("p",[t._v("Mask map")])])])}],i=(a("99af"),a("4de4"),a("4160"),a("caad"),a("c975"),a("d81d"),a("b0c0"),a("2532"),a("498a"),a("159b"),a("96cf"),a("1da1")),s={name:"App",data:function(){return{isLoading:!1,isToggle:!1,apiData:[],selected:{county:"臺北市",town:null},map:null,OSMUrl:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"}},computed:{getCounty:function(){var t=this.apiData.map((function(t){return t.properties.county})),e=t.filter((function(t,e,a){return a.indexOf(t)===e&&t.trim()}));return e},getTown:function(){var t=this,e=this.apiData.filter((function(e){return e.properties.county===t.selected.county})).map((function(t){return t.properties.town})),a=e.filter((function(t,e,a){return a.indexOf(t)===e}));return a},filterPharmacy:function(){var t=this,e=this.apiData.filter((function(e){return t.selected.town?e.properties.county.includes(t.selected.county)&&e.properties.town.includes(t.selected.town):e.properties.county.includes(t.selected.county)}));return e},filterMaskCount:function(){return this.filterPharmacy.filter((function(t){return t.properties.mask_adult||t.properties.mask_child}))}},mounted:function(){this.map=this.$utils.map.createMap("map",{zoomControl:!1}),L.control.zoom({position:"topright"}).addTo(this.map),this.$utils.map.createTileLayer(this.map,this.OSMUrl,{maxZoom:19,attribution:"© Jed Chang"}),this.map.setView([25,121.74739],8),this.getAPI()},methods:{getAPI:function(){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.isLoading=!0,e.next=3,t.axios.get("https://raw.githubusercontent.com/kiang/pharmacies/master/json/points.json").then((function(e){t.apiData=e.data.features;var a=t.setMarker(t.apiData);t.map.addLayer(a),t.isLoading=!1})).catch((function(t){throw new Error(t)}));case 3:case"end":return e.stop()}}),e)})))()},clickPharmacy:function(t){var e=[t.geometry.coordinates[1],t.geometry.coordinates[0]];this.map.setView(e,18),this.map.flyTo(e,18);var a=this.$utils.map.createPopup({maxWidth:350,minWidth:250,className:"map-popup"});a.setLatLng(e).setContent(this.popupContent(t)),this.map.openPopup(a)},setMarker:function(t){var e=this,a=this.$utils.map.createMakerCluster();return t.forEach((function(t){var n=e.$utils.map.createMakerByXY(t.geometry.coordinates,{icon:e.$utils.map.blueIcon}),r=e.$utils.map.createPopup({maxWidth:350,minWidth:250,className:"map-popup"});r.setContent(e.popupContent(t)),n.bindPopup(r),a.addLayer(n)})),a},popupContent:function(t){return"\n        <h3>".concat(t.properties.name,'</h3>\n        <p>\n          <i class="material-icons">location_on</i>\n          ').concat(t.properties.address,'\n        </p>\n        <p>\n          <i class="material-icons">call</i>\n          ').concat(t.properties.phone,'\n        </p>\n        <div class="mask-counts">\n        <div class="count adult ').concat(t.properties.mask_adult?"":"zero",'">\n          <p>成人口罩</p>\n          <h4>').concat(t.properties.mask_adult,'<span>片</span></h4>\n          <div class="icon"></div>\n        </div>\n        <div class="count child ').concat(t.properties.mask_child?"":"zero",'">\n          <p>兒童口罩</p>\n          <h4>').concat(t.properties.mask_child,'<span>片</span></h4>\n          <img class="icon" src="@/assets/images/child-mask.svg" alt="">\n        </div>\n      </div>\n      ')}}},c=s,l=(a("5c0b"),a("2877")),p=Object(l["a"])(c,r,o,!1,null,null,null),u=p.exports,d=a("bc3a"),f=a.n(d),m=a("a7fe"),h=a.n(m),v=a("2f62");n["a"].use(v["a"]);var g=new v["a"].Store({state:{},mutations:{},actions:{},modules:{}}),y=a("e11e"),_=a.n(y),k=(a("6cc5"),a("8243"),a("3ac1"),a("2573"),a("6397")),w=a.n(k),b=a("e2b9"),C=a.n(b),x=_.a.icon({iconUrl:w.a,shadowUrl:C.a});_.a.Marker.prototype.options.icon=x;var P=function(t,e){var a=_.a.map(t,e);return a},M=function(t,e,a){var n=_.a.tileLayer(e,a);return n.addTo(t),n},j=function(t){return _.a.icon(t)},O=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=_.a.marker(_.a.latLng(t[1],t[0]),e);return a},T=function(t){var e=_.a.popup(t);return e},$=function(){return _.a.markerClusterGroup()},z=new _.a.icon({iconUrl:"https://images2.imgbox.com/13/62/ytyBrz01_o.png",shadowUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/0.7.7/images/marker-shadow.png",iconSize:[45,45],iconAnchor:[22,11],popupAnchor:[0,0]}),S=new _.a.icon({iconUrl:"https://cdn.rawgit.com/pointhi/leaflet-color-markers/master/img/marker-icon-grey.png",shadowUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/0.7.7/images/marker-shadow.png"}),D={createMap:P,createTileLayer:M,createIcon:j,createMakerByXY:O,createPopup:T,createMakerCluster:$,blueIcon:z,greyIcon:S},U={map:D},A=a("9062"),I=a.n(A),E=(a("e40d"),a("4989"),a("ab8b"),a("ecee")),N=a("ad3d"),W=a("c074"),B=a("b702"),J=a("f2d1");n["a"].component("Loading",I.a),n["a"].config.productionTip=!1,n["a"].use(h.a,f.a),E["c"].add(W["b"],W["c"],W["d"],W["a"],B["a"],J["a"]),n["a"].component("fa",N["a"]),n["a"].prototype.$utils=U,new n["a"]({store:g,render:function(t){return t(u)}}).$mount("#app")},"5c0b":function(t,e,a){"use strict";a("9c0c")},"7ffa":function(t,e,a){t.exports=a.p+"img/child-mask.2b3e2fbf.svg"},"9c0c":function(t,e,a){},ace3:function(t,e,a){t.exports=a.p+"img/mask-map-logo.3b674476.svg"},edfe:function(t,e,a){t.exports=a.p+"img/adult-mask.55921f66.svg"}});
//# sourceMappingURL=app.4ca68f51.js.map